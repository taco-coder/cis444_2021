<!DOCTYPE html>
<html>
    <head>
        <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
        <style>
            body{
                font-family: 'Courier New', Courier, monospace;
            }
            #book-details, #book-cover, #testimonies{
                display: inline-block;
                vertical-align: middle;
            }
            #testimonies{
                width: 300px;
                height: 300px;
            }
            .quote{
                background: lightgray;
                border: 1px solid black;        
                border-radius: 20px;
                padding: 10px;
            }
            #book-details{
                margin-left: 100px;
                padding-right: 250px;
                width: 400px;
                wordwrap: normal;
            }
            #book-cover{
                margin-left: 150px;
            }
            #buy_button, #price{
                display: inline;
            }
            #buy_button{
                margin-left: 40px;
                border: none;
                outline: none;
                padding: 10px 16px;
                border-radius:5px;
                background-color: coral;
                color: white;
                cursor: pointer;
                font-size: 18px;
                transition-duration: 0.3s;                
            }
            #buy_button:hover{
                background-color: white;
                color: coral;
                border: 1px solid coral; 
            }
            .btn {
                border: none;
                outline: none;
                padding: 10px 16px;
                border-radius:5px;
                background-color: coral;
                color: white;
                cursor: pointer;
                font-size: 18px;
                transition-duration: 0.3s;  
            }  
            .btn:hover {
                background-color: white;
                color: coral;
                border-radius: 10px;
                border: 1px solid coral;        
            }             
            #cart_btn{
                margin-left: 92%;
                margin-top: -40px;
            }
            #description, #review-section{
                margin-left: 150px;
                margin-right: 150px;
            }
        </style>
    </head>
    <body>	
        <div id="myDIV">
        <form action="/back_to_store" method="get">
            <input type="submit" class="btn" value="Go Back &#8617">
        </form>
        </div>
        <form id = "cart_btn" action="/cart" method="get">
            <input type="submit" class="btn" value="Go to Cart &#128722">
        </form>        
        <div id="book-cover">
            <img width="450px" height="450px" style="border-radius: 5px;" src="https://red-lepanka-images.s3.amazonaws.com/1629591299654.png"/>
        </div>
        <div id="book-details">
            <h1 style="margin-bottom: 200px; font-size: 50px;">{{bookname}}</h1>
            <h3 id= "price">Price: {{price}}</h3>
            <form action="/add_to_cart" method="post">
                <input type="hidden" id="bookname" name="book_name" value="Red Lepanka">
                <input type="hidden" id="bookprice" name="book_price" value={{price}}>
                <input type="submit" id="buy_button" class="inner" value="Add to Cart &#128722">
            </form>
        </div>
        <div id="testimonies">
            <p class="quote"><q>The girlboss story of the decade.</q> - Reshma Saujani, Founder of Girls Who Code</p>
            <br>
            <p class="quote"><q>James Bond just met his female match.</q> - The New York Times</p>
        </div>
        <div id="description">
            <h2>Description</h2>
            <hr>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam varius ipsum tristique, dignissim quam ut, tempus ex. 
            Morbi pulvinar purus ut odio rutrum aliquam. Aliquam non volutpat odio, sit amet pharetra lorem. 
            Ut vehicula elementum nulla, sit amet sodales nisl finibus varius. Donec eu sollicitudin nunc, non auctor nibh.
            Ut ultricies finibus elit ut scelerisque. Nam nec tincidunt massa, quis molestie massa. Interdum et malesuada fames ac ante ipsum primis in faucibus.
             Nunc ligula enim, dictum eget nunc eu, egestas tempor lacus. In et hendrerit velit. Praesent ac egestas libero.
             Maecenas convallis felis quis ex posuere malesuada. Mauris id nisi vel nunc maximus efficitur in vel sem. </p>
        </div>
        <div id="review-section">
                <h2>Reviews</h2>
                <h4 id="avg-rate"></h4>
            <hr>
            <div id="user-review"></div>
            <div id="post-review" style="display:inline-block;">    
            <hr>        
            <h2>Leave a review:</h2>
                <form id="post-review" action="/post_review" method="post">
                    <label for="rate" style="font-size: 18px;">Rate:</label>
                    <select class="btn" name="rate" id="rate">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                    <input type="hidden" name="book_id" value="1">
                    <input class ="btn" type="submit" value="Post Review">
                    <textarea rows="6" cols="195" placeholder="Leave a review within 255 characters" maxlength="255" name="reviewtext" required></textarea>                    
                </form>

            </div>
        </div>
    </body>
    <script>
        $('#bookprice').val(books.books[0][2]);    
        var user_reviews = {{reviews | tojson}}
        var avgRate = 0;
        for(let i = 0; i < Object.keys(user_reviews).length; i++){
            $("#user-review").append("Rated: "+ user_reviews[i][2] + "/5 - " + user_reviews[i][1])
            avgRate += user_reviews[i][2]
            $("#user-review").append("<br><br>")
        }
        console.log(avgRate)
        avgRate = avgRate / Object.keys(user_reviews).length
        console.log(avgRate)
        $("#avg-rate").html("Rating: " + avgRate.toFixed(1) + "/5")
    </script>
</html>
